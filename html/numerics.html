

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Not only symbolics: numerical computing &mdash; SymPy tutorial at SciPy 2011 conferences</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://localhost:8080/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://localhost:8080/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="/mathjax/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://localhost:8080/static/external/ext-core.js"></script>
    <script type="text/javascript" src="http://localhost:8080/static/live-core.js"></script>
    <script type="text/javascript" src="http://localhost:8080/static/live-sphinx.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="SymPy tutorial at SciPy 2011 conferences" href="index.html" />
    <link rel="up" title="Mathematical problem solving with SymPy" href="mathematics.html" />
    <link rel="next" title="Summing roots of polynomials" href="summation.html" />
    <link rel="prev" title="Deriving trigonometric identities" href="trigonometry.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="summation.html" title="Summing roots of polynomials"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="trigonometry.html" title="Deriving trigonometric identities"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" accesskey="U">Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="not-only-symbolics-numerical-computing">
<h1>Not only symbolics: numerical computing<a class="headerlink" href="#not-only-symbolics-numerical-computing" title="Permalink to this headline">¶</a></h1>
<p>Symbolic mathematics can&#8217;t exist without numerical methods. Most &#8220;symbolic&#8221;
modules in SymPy take at least some advantage of numerical computing. SymPy
uses the mpmath library for this purpose.</p>
<p>Let&#8217;s start from something simple and find numerical approximation to <span class="math">\(\pi\)</span>.
Normally SymPy represents <span class="math">\(\pi\)</span> as a symbolic entity:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span>
<span class="go">π</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sympy.core.numbers.Pi&#39;&gt;</span>
</pre></div>
</div>
<p>To obtain numerical approximation of <span class="math">\(\pi\)</span> we can use either the <tt class="xref py py-func docutils literal"><span class="pre">evalf()</span></tt>
method or <tt class="xref py py-func docutils literal"><span class="pre">N()</span></tt>, which is a simple wrapper over the former method:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">3.14159265358979</span>
</pre></div>
</div>
<p>The default precision is 15 digits. We can change this using the <tt class="docutils literal"><span class="pre">n</span></tt> parameter:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">30</span><span class="p">)</span>
<span class="go">3.14159265358979323846264338328</span>
</pre></div>
</div>
<p>The mpmath library implements arbitrary precision floating point arithmetics
(limited only by available memory), so we can set <tt class="docutils literal"><span class="pre">n</span></tt> to a very big value,
e.g. one million:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">million_digits</span> <span class="o">=</span> <span class="n">pi</span><span class="o">.</span><span class="n">evalf</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">million_digits</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">5</span>
</pre></div>
</div>
<p><tt class="xref py py-func docutils literal"><span class="pre">evalf()</span></tt> can handle much more complex expressions than <span class="math">\(\pi\)</span>, for
example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">exp</span><span class="p">(</span><span class="n">sin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="n">E</span><span class="o">**</span><span class="n">pi</span> <span class="o">-</span> <span class="n">I</span><span class="p">)</span>
<span class="go">           π</span>
<span class="go"> sin(1) + ℯ  - ⅈ</span>
<span class="go">ℯ</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">14059120207.1707 - 21895782412.4995⋅ⅈ</span>
</pre></div>
</div>
<p>or:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span>
<span class="go"> ⎛14⎞</span>
<span class="go">ζ⎜──⎟</span>
<span class="go"> ⎝17⎠</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">zeta</span><span class="p">(</span><span class="n">S</span><span class="p">(</span><span class="mi">14</span><span class="p">)</span><span class="o">/</span><span class="mi">17</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">-5.10244976858838</span>
</pre></div>
</div>
<p>Note that in SymPy, <tt class="docutils literal"><span class="pre">exp(1)</span></tt> is denoted by capital :exp:<tt class="docutils literal"><span class="pre">E</span></tt></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">E</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">2.71828182845905</span>
</pre></div>
</div>
<p>Symbolic entities are ignored:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">pi</span><span class="o">*</span><span class="n">x</span>
<span class="go">π⋅x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">_</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">3.14159265358979⋅x</span>
</pre></div>
</div>
<p>Built-in functions <tt class="xref py py-func docutils literal"><span class="pre">float()</span></tt> and <tt class="xref py py-func docutils literal"><span class="pre">complex()</span></tt> take advantage of
<tt class="xref py py-func docutils literal"><span class="pre">evalf()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">pi</span><span class="p">)</span>
<span class="go">3.14159265359</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;type &#39;float&#39;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">float</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">ValueError</span>: <span class="n">Symbolic value, can&#39;t compute</span>

<span class="gp">&gt;&gt;&gt; </span><span class="nb">complex</span><span class="p">(</span><span class="n">pi</span><span class="o">*</span><span class="n">I</span><span class="p">)</span>
<span class="go">3.14159265359j</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;type &#39;complex&#39;&gt;</span>
</pre></div>
</div>
<p>The base type for computing with floating point numbers in SymPy is
<tt class="xref py py-class docutils literal"><span class="pre">Float</span></tt>. It allows for several flavors of initialization and
keeps track of precision:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mf">2.0</span>
<span class="go">2.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;type &#39;float&#39;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Float</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="go">2.00000000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sympy.core.numbers.Float&#39;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sympify</span><span class="p">(</span><span class="mf">2.0</span><span class="p">)</span>
<span class="go">2.00000000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">type</span><span class="p">(</span><span class="n">_</span><span class="p">)</span>
<span class="go">&lt;class &#39;sympy.core.numbers.Float&#39;&gt;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">Float</span><span class="p">(</span><span class="s">&quot;3.14&quot;</span><span class="p">)</span>
<span class="go">3.14000000000000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Float</span><span class="p">(</span><span class="s">&quot;3.14e-400&quot;</span><span class="p">)</span>
<span class="go">3.14000000000000e-400</span>
</pre></div>
</div>
<p>Notice that the last value is out of range for <tt class="docutils literal"><span class="pre">float</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mf">3.14e-400</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>We expected a very small value but not zero. This raises an important issue,
because if we try to construct a <tt class="xref py py-class docutils literal"><span class="pre">Float</span></tt> this way, we will still get
zero:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Float</span><span class="p">(</span><span class="mf">3.14e-400</span><span class="p">)</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The only way to fix this is to pass a string argument to <tt class="xref py py-class docutils literal"><span class="pre">Float</span></tt>.</p>
<div class="section" id="when-symbolic-mathematics-matter">
<h2>When symbolic mathematics matter?<a class="headerlink" href="#when-symbolic-mathematics-matter" title="Permalink to this headline">¶</a></h2>
<p>Consider a univariate function:</p>
<div class="math">
\[f(x) = x^{(1 - \log(\log(\log(\log(\frac{1}{x})))))}\]</div>
<p>We would like to compute:</p>
<div class="math">
\[\lim_{x \to 0^{+}} f(x)\]</div>
<p>Let&#8217;s define the function <span class="math">\(f\)</span> in SymPy:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)))))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span>
<span class="go">      ⎛   ⎛   ⎛   ⎛1⎞⎞⎞⎞</span>
<span class="go"> - log⎜log⎜log⎜log⎜─⎟⎟⎟⎟ + 1</span>
<span class="go">      ⎝   ⎝   ⎝   ⎝x⎠⎠⎠⎠</span>
<span class="go">x</span>
</pre></div>
</div>
<p>A very straight forward approach is to &#8220;see&#8221; how <span class="math">\(f\)</span> behaves on the right
hand side of zero. We can try to read the solution from the graph of <span class="math">\(f\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">sympy.mpmath</span> <span class="kn">import</span> <span class="n">plot</span><span class="p">,</span> <span class="n">log</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">axes</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
<span class="n">axes</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s">r&quot;Plot of $f(x)$ in $[0, 0.01]$.&quot;</span><span class="p">)</span>

<span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">**</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="n">log</span><span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="n">x</span><span class="p">)))))</span>
<span class="n">plot</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">xlim</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">],</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href=".//numerics-1.py">Source code</a>, <a class="reference external" href=".//numerics-1.png">png</a>, <a class="reference external" href=".//numerics-1.hires.png">hires.png</a>, <a class="reference external" href=".//numerics-1.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="_images/numerics-1.png" src="_images/numerics-1.png" />
</div>
<p>This gives us first hint that the limit might be zero. Of course reading
a graph of a function isn&#8217;t a very precise method for computing limits.
Instead of analyzing the graph of <span class="math">\(f\)</span>, we can improve this approach a
little by evaluating <span class="math">\(f(x)\)</span> for sufficiently small arguments.</p>
<p>Let&#8217;s start with arguments of the form <span class="math">\(x = 10^{-k}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">0.00114216521536353 + 0.00159920801047526⋅ⅈ</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">0.000191087007486009</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">5.60274947776528e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">1.24646630615307e-5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">2.73214471781554e-6</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">6.14631623897124e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">1.42980539541700e-7</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">3.43858142726788e-8</span>
</pre></div>
</div>
<p>We obtained a decreasing sequence values which suggests that the limit
is zero. Let&#8217;s now try points of the form <span class="math">\(x = 10^{-10^k}\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">2.17686941815359e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">4.87036575966825e-48</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">+inf</span>
</pre></div>
</div>
<p>For <span class="math">\(x = 10^{-10^3}\)</span> we got a very peculiar value. This happened because:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="mi">10</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span>
<span class="go">0.0</span>
</pre></div>
</div>
<p>and the reason for this is that we used Python&#8217;s floating point values.
Instead we can use either exact numbers or SymPy&#8217;s floating point numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">Integer</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span> <span class="o">!=</span> <span class="mi">0</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Let&#8217;s continue with SymPy&#8217;s floating point numbers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">2.17686941815359e-9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">4.87036575966825e-48</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">1.56972853078736e-284</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">3.42160969045530e-1641</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">1.06692865269193e-7836</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">4.40959214078817e-12540</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">1.11148303902275e+404157</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">subs</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">Float</span><span class="p">(</span><span class="mf">10.0</span><span class="p">)</span><span class="o">**-</span><span class="mi">10</span><span class="o">**</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">evalf</span><span class="p">()</span>
<span class="go">8.63427256445142e+8443082</span>
</pre></div>
</div>
<p>This time the sequence of values is rapidly decreasing, but only until
a sufficiently small numer where <span class="math">\(f\)</span> has an inflexion point. After that,
values of <span class="math">\(f\)</span> increase very rapidly, which may suggest that the actual
limit is <tt class="docutils literal"><span class="pre">+\inf</span></tt>. It seems that our initial guess is wrong. However, for
now we still can&#8217;t draw any conclusions about behavior of <span class="math">\(f\)</span>, because
if we take even smaller numbers we may reach other points of inflection.</p>
<p>The mpmath library implements a function for computing numerical limits
of function, we can try to take advantage of this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sympy.mpmath</span> <span class="kn">import</span> <span class="n">limit</span> <span class="k">as</span> <span class="n">nlimit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">F</span> <span class="o">=</span> <span class="n">lambdify</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">modules</span><span class="o">=</span><span class="s">&#39;mpmath&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">nlimit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">(2.23372778188847e-5 + 2.28936592344331e-8j)</span>
</pre></div>
</div>
<p>This once again suggests that the limit is zero. Let&#8217;s use an exponential
distribution of points in <tt class="xref py py-func docutils literal"><span class="pre">nlimit()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">nlimit</span><span class="p">(</span><span class="n">F</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">exp</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="go">(3.43571317799366e-20 + 4.71360839667667e-23j)</span>
</pre></div>
</div>
<p>This didn&#8217;t help much. Still zero. The only solution to this problem
is to use analytic methods. For this we will use <tt class="xref py py-func docutils literal"><span class="pre">limit()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">limit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="go">∞</span>
</pre></div>
</div>
<p>which shows us that our initial guess was completely wrong. This nicely
shows that solving ill conditioned problems may require assistance of
symbolic mathematics system. More about this can be found in Dominic
Gruntz&#8217;s PhD tesis (<a class="reference external" href="http://www.cybertester.com/data/gruntz.pdf">http://www.cybertester.com/data/gruntz.pdf</a>), where
this problem is explained in detail and an algorithm shown, which can
solve this problem and which is implemented in SymPy.</p>
</div>
<div class="section" id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">Compute first 55 digits of numerical approximation of <span class="math">\(f(\pi)\)</span>.</p>
<p>(<a class="reference internal" href="extras.html#solution-numerics-1"><em>solution</em></a>)</p>
</li>
<li><p class="first">Read this <a class="reference external" href="http://www.qwantz.com/index.php?comic=1013">webcomic</a>.
What is the first digit of <span class="math">\(e\)</span> to contain <span class="math">\(999999\)</span>? What is the first
digit of <span class="math">\(\pi\)</span> to contain <span class="math">\(789\)</span>?</p>
<p>(<a class="reference internal" href="extras.html#solution-numerics-2"><em>solution</em></a>)</p>
</li>
<li><p class="first">In addition to the above example, Gruntz gives another example of ill
conditioned function in his thesis to show why symbolic computation of
limits can be preferred to numerical computation:</p>
<div class="math">
\[\lim_{x \to \infty}{\left(\operatorname{erf}\left(x - {e^{-e^{x}}}\right) -
    \operatorname{erf}\left(x\right)\right) e^{e^{x}}} e^{x^{2}}\]</div>
<p>(in SymPy, <tt class="docutils literal"><span class="pre">(erf(x</span> <span class="pre">-</span> <span class="pre">exp(-exp(x)))</span> <span class="pre">-</span> <span class="pre">erf(x))*exp(exp(x))*exp(x**2)</span></tt>).
Compute the above limit in SymPy using methods similar to the ones presented
in this section. What are the drawbacks of computing this limit numerically?
What is the limit, exactly?</p>
<p>(<a class="reference internal" href="extras.html#solution-numerics-3"><em>solution</em></a>)</p>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/sympy-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Not only symbolics: numerical computing</a><ul>
<li><a class="reference internal" href="#when-symbolic-mathematics-matter">When symbolic mathematics matter?</a></li>
<li><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="trigonometry.html"
                        title="previous chapter">Deriving trigonometric identities</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="summation.html"
                        title="next chapter">Summing roots of polynomials</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/numerics.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="summation.html" title="Summing roots of polynomials"
             >next</a> |</li>
        <li class="right" >
          <a href="trigonometry.html" title="Deriving trigonometric identities"
             >previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" >Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Mateusz Paprocki, Aaron Meurer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>