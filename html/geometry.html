

<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Algebraic geometry &mdash; SymPy tutorial at SciPy 2011 conferences</title>
    
    <link rel="stylesheet" href="_static/extra.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-core.css" type="text/css" />
    <link rel="stylesheet" href="http://live.sympy.org/static/live-sphinx.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '',
        VERSION:     '1.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML-full"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/external/ext-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-core.js"></script>
    <script type="text/javascript" src="http://live.sympy.org/static/live-sphinx.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <link rel="top" title="SymPy tutorial at SciPy 2011 conferences" href="index.html" />
    <link rel="up" title="Mathematical problem solving with SymPy" href="mathematics.html" />
    <link rel="next" title="Extras" href="extras.html" />
    <link rel="prev" title="Applications of Gröbner bases" href="groebner.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="extras.html" title="Extras"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="groebner.html" title="Applications of Gröbner bases"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" accesskey="U">Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="algebraic-geometry">
<h1>Algebraic geometry<a class="headerlink" href="#algebraic-geometry" title="Permalink to this headline">¶</a></h1>
<p>Let&#8217;s consider a geometric entity (e.g. line, square), whose properties can
be described using a system of <span class="math">\(m\)</span> polynomials:</p>
<div class="math">
\[\mathcal{H} = \{h_1, \ldots, h_m\}\]</div>
<p>We will call <span class="math">\(\mathcal{H}\)</span> a hypothesis. Given a theorem concerning this
geometric entity, the algebraic formulation is as follows:</p>
<div class="math">
\[\forall_{x_1, \ldots, x_n, y_1, \ldots, y_n} (h_1 = 0 \vee \ldots \vee h_m = 0) \Rightarrow g = 0\]</div>
<p>where <span class="math">\(g\)</span> is the conclusion of the theorem and <span class="math">\(h_1, \ldots h_m\)</span> and <span class="math">\(g\)</span>
are polynomials in <span class="math">\(\mathrm{K}[x_1, \ldots, x_n, y_1, \ldots, y_n]\)</span>. It
follows from the Gröbner bases theory that the above statement is true
when <span class="math">\(g\)</span> belongs to the ideal generated by <span class="math">\(\mathcal{H}\)</span>. To check this,
i.e. to prove the theorem, it is sufficient to compute a Gröbner basis
of <span class="math">\(\mathcal{H}\)</span> with respect to any admissible monomial ordering and
reduce <span class="math">\(g\)</span> with respect to this basis. If the theorem is true then the
remainder from the reduction will vanish. In this example, for the sake
of simplicity, we assume that the geometric entity is non&#8211;degenerate,
i.e. it does not collapse into a line or a point.</p>
<p>Let&#8217;s consider the following rhombus:</p>
<div class="figure align-center" id="fig-geometry-rhombus">
<img alt="_images/geometry-rhombus.png" src="_images/geometry-rhombus.png" />
<p class="caption">A rhombus in a fixed coordinate system.</p>
</div>
<p>This geometric entity consists of four points <span class="math">\(A\)</span>, <span class="math">\(B\)</span>, <span class="math">\(C\)</span> and <span class="math">\(D\)</span>. To
setup a fixed coordinate system, without loss of generality, we can assume
that <span class="math">\(A = (0, 0)\)</span>, <span class="math">\(B = (x_B, 0)\)</span>, <span class="math">\(C = (x_C, y_C)\)</span> and <span class="math">\(D = (x_D, y_D)\)</span>.
This is possible by taking rotational invariance of the geometric entity.
We will prove that the diagonals of this rhombus, i.e. <span class="math">\(AD\)</span> and <span class="math">\(BC\)</span> are
mutually perpendicular. We have the following conditions describing <span class="math">\(ABCD\)</span>:</p>
<ol class="arabic simple">
<li>Line <span class="math">\(AD\)</span> is parallel to <span class="math">\(BC\)</span>, i.e. <span class="math">\(AD \parallel BC\)</span>.</li>
<li>Sides of <span class="math">\(ABCD\)</span> are of the equal length, i.e. <span class="math">\(AB = BC\)</span>.</li>
<li>The rhombus is non&#8211;degenerate, i.e. is not a line or a point.</li>
</ol>
<p>Our conclusion is that <span class="math">\(AC \bot BD\)</span>. To prove this theorem, first we need to
transform the above conditions and the conclusion into a set of polynomials.
How we can achieve this? Let&#8217;s focus on the first condition. In general, we
are given two lines <span class="math">\(A_1A_2\)</span> and <span class="math">\(B_1B_2\)</span>. To express the relation between
those two lines, i.e. that <span class="math">\(A_1A_2\)</span> is parallel <span class="math">\(B_1B_2\)</span>, we can relate
slopes of those lines:</p>
<div class="math">
\[\frac{y_{A_2} - y_{A_1}}{x_{A_2} - x_{A_1}} = \frac{y_{B_2} - y_{B_1}}{x_{B_2} - x_{B_1}}\]</div>
<p>Clearing denominators in the above expression and putting all terms on the
left hand side of the equation, we derive a general polynomial describing the
first condition. This can be literally translated into Python:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">parallel</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Line [A1, A2] is parallel to line [B1, B2]. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">B1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">B2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">B1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>assuming that <tt class="docutils literal"><span class="pre">A1</span></tt>, <tt class="docutils literal"><span class="pre">A2</span></tt>, <tt class="docutils literal"><span class="pre">B1</span></tt> and <tt class="docutils literal"><span class="pre">B2</span></tt> are instances of <tt class="xref py py-class docutils literal"><span class="pre">Point</span></tt>
class. In the case of our rhombus, we will take advantage of the fixed coordinate
system and simplify the resulting polynomials as much as possible. The same
approach can be used to derive polynomial representation of the other conditions
and the conclusion. To construct <span class="math">\(\mathcal{H}\)</span> and <span class="math">\(g\)</span> we will use the following
functions:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">distance</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;The squared distance between points A1 and A2. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>

<span class="k">def</span> <span class="nf">equal</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Lines [A1, A2] and [B1, B2] are of the same width. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">distance</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">)</span> <span class="o">-</span> <span class="n">distance</span><span class="p">(</span><span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">perpendicular</span><span class="p">(</span><span class="n">A1</span><span class="p">,</span> <span class="n">A2</span><span class="p">,</span> <span class="n">B1</span><span class="p">,</span> <span class="n">B2</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Line [A1, A2] is perpendicular to line [B1, B2]. &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B2</span><span class="o">.</span><span class="n">x</span> <span class="o">-</span> <span class="n">B1</span><span class="o">.</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">A2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">A1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">B2</span><span class="o">.</span><span class="n">y</span> <span class="o">-</span> <span class="n">B1</span><span class="o">.</span><span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>The non&#8211;degeneracy statement requires a few words of comment. Many theorems
in geometry are true only in the non&#8211;degenerative case and false or undefined
otherwise. In our approach to theorem proving in algebraic geometry, we must
supply sufficient non&#8211;degeneracy conditions manually. In the case of our
rhombus this is <span class="math">\(x_B &gt; 0\)</span> and <span class="math">\(y_C &gt; 0\)</span> (we don&#8217;t need to take <span class="math">\(x_C\)</span> into
account because <span class="math">\(AB = BC\)</span>). At first, this seems to be a show stopper, as
Gröbner bases don&#8217;t support inequalities. However, we can use Rabinovich&#8217;s
trick and transform those inequalities into a single polynomial condition by
introducing an additional variable, e.g. <span class="math">\(a\)</span>, about which we will assume that
is positive. This gives us a non&#8211;degeneracy condition <span class="math">\(x_B y_C - a\)</span>.</p>
<p>With all this knowledge we are ready to prove the main theorem. First, let&#8217;s
declare variables:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">var</span><span class="p">(</span><span class="s">&#39;x_B, x_C, y_C, x_D, a&#39;</span><span class="p">)</span>
<span class="go">(x_B, x_C, y_C, x_D, a)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">V</span> <span class="o">=</span> <span class="n">_</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>We declared the additional variable <span class="math">\(a\)</span>, but we don&#8217;t consider it a variable
of our problem. Let&#8217;s now define the four points <span class="math">\(A\)</span>, <span class="math">\(B\)</span>, <span class="math">\(C\)</span> and <span class="math">\(D\)</span>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">B</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x_B</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">C</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x_C</span><span class="p">,</span> <span class="n">y_C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">D</span> <span class="o">=</span> <span class="n">Point</span><span class="p">(</span><span class="n">x_D</span><span class="p">,</span> <span class="n">y_C</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the previously defined functions we can formulate the hypothesis:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">h1</span> <span class="o">=</span> <span class="n">parallel</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">D</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h2</span> <span class="o">=</span> <span class="n">equal</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">C</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h3</span> <span class="o">=</span> <span class="n">x_B</span><span class="o">*</span><span class="n">y_C</span> <span class="o">-</span> <span class="n">a</span>
</pre></div>
</div>
<p>and compute its Gröbner basis:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">G</span> <span class="o">=</span> <span class="n">groebner</span><span class="p">([</span><span class="n">f1</span><span class="p">,</span> <span class="n">h2</span><span class="p">,</span> <span class="n">h3</span><span class="p">],</span> <span class="o">*</span><span class="n">V</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;grlex&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We had to specify the variables of the problem explicitly in
<tt class="xref py py-func docutils literal"><span class="pre">groebner()</span></tt>, because otherwise it would treat <span class="math">\(a\)</span> also as a
variable, which we don&#8217;t want. Now we can verify the theorem:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">reduced</span><span class="p">(</span><span class="n">perpendicular</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">B</span><span class="p">,</span> <span class="n">D</span><span class="p">),</span> <span class="n">G</span><span class="p">,</span> <span class="o">*</span><span class="n">V</span><span class="p">,</span> <span class="n">order</span><span class="o">=</span><span class="s">&#39;grlex&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">0</span>
</pre></div>
</div>
<p>The remainder vanished, which proves that <span class="math">\(AC \bot BD\)</span>. Although, the theorem
we described and proved here is a simple one, one can handle much more advanced
problems as well using Gröbner bases techniques. One should refer to Franz
Winkler&#8217;s papers for more advanced examples.</p>
<div class="section" id="tasks">
<h2>Tasks<a class="headerlink" href="#tasks" title="Permalink to this headline">¶</a></h2>
<ol class="arabic">
<li><p class="first">The Gröbner bases method is a generalization of Gaussian elimination
and Euclid&#8217;s algorithms. Try to solve a linear system and compute GCD
of polynomials using <tt class="xref py py-func docutils literal"><span class="pre">groebner()</span></tt>. Compare the results and speed of
computations with <tt class="xref py py-func docutils literal"><span class="pre">solve()</span></tt> and <tt class="xref py py-func docutils literal"><span class="pre">gcd()</span></tt>.</p>
<p>(<a class="reference internal" href="extras.html#solution-geometric-1"><em>solution</em></a>)</p>
</li>
</ol>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/sympy-logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Algebraic geometry</a><ul>
<li><a class="reference internal" href="#tasks">Tasks</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="groebner.html"
                        title="previous chapter">Applications of Gröbner bases</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="extras.html"
                        title="next chapter">Extras</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/geometry.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="extras.html" title="Extras"
             >next</a> |</li>
        <li class="right" >
          <a href="groebner.html" title="Applications of Gröbner bases"
             >previous</a> |</li>
        <li><a href="index.html">SymPy tutorial at SciPy 2011 conferences</a> &raquo;</li>
          <li><a href="mathematics.html" >Mathematical problem solving with SymPy</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2011, Mateusz Paprocki, Aaron Meurer.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 1.1.2.
    </div>
  </body>
</html>